<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sendero 11</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a1a;
            color: #e0e0e0;
            overflow-x: hidden;
        }
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
        }
        .glassmorphism {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: background 0.3s ease, border 0.3s ease;
        }
        .main-title {
            font-family: 'Playfair Display', serif;
        }
        .glow-button {
            transition: all 0.3s ease;
            box-shadow: 0 0 5px rgba(0, 191, 255, 0.5), 0 0 10px rgba(0, 191, 255, 0.3);
        }
        .glow-button:hover {
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.8), 0 0 25px rgba(0, 191, 255, 0.5);
            transform: translateY(-2px);
        }
        .info-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .info-card:hover {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 0.1);
        }
        .modal-enter {
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body class="min-h-screen">
    <div id="particles-js"></div>

    <main class="container mx-auto p-4 md:p-8 relative z-10">

        <!-- PASO 1: EL PORTAL DE ENTRADA -->
        <section id="portal" class="flex min-h-screen flex-col items-center justify-center text-center transition-opacity duration-1000">
            <img src="https://raw.githubusercontent.com/EdddGaar/Numerologia/main/sendero%2011%20ver2.png" alt="Logo Sendero 11" class="w-48 h-48 mb-8">
            <p class="text-lg md:text-xl text-gray-300 mb-8 max-w-2xl">Descubre los secretos que los números tienen para ti. Ingresa tus datos para revelar tu sendero cósmico.</p>
            
            <form id="numerology-form" class="w-full max-w-lg space-y-4">
                <div>
                    <input type="text" id="name" placeholder="Tu nombre completo" class="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-center text-lg focus:outline-none focus:ring-2 focus:ring-cyan-400 transition" required>
                </div>
                <div>
                    <input type="date" id="birthdate" class="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-center text-lg focus:outline-none focus:ring-2 focus:ring-cyan-400 transition" required>
                </div>
                <button type="submit" class="w-full p-3 bg-cyan-500 text-white font-bold rounded-lg text-lg glow-button">
                    Descifrar mi Código
                </button>
            </form>
        </section>

        <!-- PASO 2: EL CÓDICE PERSONAL (Resultados) -->
        <section id="results" class="hidden opacity-0 transition-opacity duration-1000 space-y-12">
            <div class="pt-8">
                 <h2 class="main-title text-4xl sm:text-5xl font-bold text-center mb-12 text-white">Tu Códice Personal, <span id="user-name-title" class="text-cyan-400"></span></h2>
                 <div id="codice-cards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 text-center">
                    <div id="camino-vida-card" class="glassmorphism rounded-2xl h-56 info-card flex flex-col justify-center items-center p-4"></div>
                    <div id="alma-card" class="glassmorphism rounded-2xl h-56 info-card flex flex-col justify-center items-center p-4"></div>
                    <div id="personalidad-card" class="glassmorphism rounded-2xl h-56 info-card flex flex-col justify-center items-center p-4"></div>
                    <div id="regalo-card" class="glassmorphism rounded-2xl h-56 info-card flex flex-col justify-center items-center p-4"></div>
                    <div id="karma-card" class="glassmorphism rounded-2xl h-56 info-card flex flex-col justify-center items-center p-4"></div>
                    <div id="ano-personal-card" class="glassmorphism rounded-2xl h-56 info-card flex flex-col justify-center items-center p-4"></div>
                 </div>
            </div>
            
            <!-- SECCIÓN CALCULADORA DE SINERGIA -->
            <div id="sinergia-section">
                <h2 class="main-title text-4xl sm:text-5xl font-bold text-center mb-8 text-white">Sinergia Cósmica</h2>
                <div class="glassmorphism p-6 rounded-2xl max-w-2xl mx-auto">
                    <p class="text-center mb-4">Analiza tu compatibilidad numerológica con socios, pareja, amigos y familia.</p>
                    <form id="sinergia-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="text" id="other-name" placeholder="Nombre completo de la otra persona" class="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-center text-lg focus:outline-none focus:ring-2 focus:ring-purple-400 transition" >
                        <input type="date" id="other-birthdate" class="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-center text-lg focus:outline-none focus:ring-2 focus:ring-purple-400 transition" >
                        <button type="submit" class="md:col-span-2 w-full p-3 bg-purple-500 text-white font-bold rounded-lg text-lg glow-button">Calcular Sinergia</button>
                    </form>
                    <div id="sinergia-result" class="mt-6 text-center min-h-[50px]"></div>
                </div>
            </div>


            <!-- Sección del Calendario -->
            <div id="calendar-section">
                <h2 id="calendar-title" class="main-title text-3xl sm:text-4xl font-bold text-center mb-4 text-white"></h2>
                <p id="calendar-subtitle" class="text-center text-gray-400 mb-8"></p>
                <div class="glassmorphism p-4 sm:p-6 rounded-2xl">
                    <div class="flex items-center justify-between mb-4">
                        <button id="prev-month" class="p-2 rounded-full hover:bg-white/10 transition">&lt;</button>
                        <h3 id="month-year" class="text-2xl font-bold text-white"></h3>
                        <button id="next-month" class="p-2 rounded-full hover:bg-white/10 transition">&gt;</button>
                    </div>
                    <div id="calendar-grid" class="grid grid-cols-7 gap-1 sm:gap-2"></div>
                </div>
            </div>
        </section>
    </main>
    
    <!-- MODAL GENERAL -->
    <div id="general-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50 hidden">
        <div id="modal-content" class="glassmorphism p-6 rounded-2xl max-w-md w-full text-center modal-enter"></div>
    </div>


    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        particlesJS("particles-js", {
            "particles": { "number": { "value": 40, "density": { "enable": true, "value_area": 800 } }, "color": { "value": "#ffffff" }, "shape": { "type": "circle" }, "opacity": { "value": 0.5, "random": false }, "size": { "value": 3, "random": true }, "line_linked": { "enable": true, "distance": 150, "color": "#ffffff", "opacity": 0.4, "width": 1 }, "move": { "enable": true, "speed": 2, "direction": "none", "out_mode": "out" } },
            "interactivity": { "detect_on": "canvas", "events": { "onhover": { "enable": true, "mode": "grab" }, "onclick": { "enable": true, "mode": "push" } } },
            "retina_detect": true
        });

        // --- LÓGICA DE NUMEROLOGÍA ---
        
        function reducirNumero(n, preserveMasters = true) {
            if (preserveMasters && (n === 11 || n === 22)) return n;
            let sum = String(n).split('').reduce((acc, digit) => acc + parseInt(digit), 0);
            if (sum > 9 && (!preserveMasters || (sum !== 11 && sum !== 22))) {
                return reducirNumero(sum, preserveMasters);
            }
            return sum;
        }

        const letterValues = { a: 1, b: 2, c: 3, d: 4, e: 5, f: 6, g: 7, h: 8, i: 9, j: 1, k: 2, l: 3, m: 4, n: 5, o: 6, p: 7, q: 8, r: 9, s: 1, t: 2, u: 3, v: 4, w: 5, x: 6, y: 7, z: 8 };
        
        function calculateNameNumber(name, type) {
            const vowels = 'aeiouáéíóú';
            let sum = 0;
            for (let char of name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "")) {
                if (type === 'vowels' && vowels.includes(char)) {
                    sum += letterValues[char] || 0;
                } else if (type === 'consonants' && !vowels.includes(char) && letterValues[char]) {
                    sum += letterValues[char] || 0;
                }
            }
            return reducirNumero(sum);
        }

        function calculateKarmaNumbers(name) {
            const presentNumbers = new Set();
            for (let char of name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "")) {
                if (letterValues[char]) {
                    presentNumbers.add(letterValues[char]);
                }
            }
            const karma = [];
            for (let i = 1; i <= 9; i++) {
                if (!presentNumbers.has(i)) {
                    karma.push(i);
                }
            }
            return karma.length > 0 ? karma : ["Ninguno"];
        }
        
        const infoNumeros = {
            caminoVida: {
                1: "Como líder natural (1), tu misión es abrir caminos, ser innovador y confiar en tu independencia. Vienes a aprender a creer en ti mismo y a liderar con valentía.",
                2: "Tu sendero (2) es el de la cooperación y la diplomacia. Tu misión es unir, mediar y crear armonía. Vienes a aprender sobre la paciencia y el poder de la colaboración.",
                3: "Naciste para comunicar y crear (3). Tu misión es inspirar alegría, optimismo y creatividad a tu alrededor. Vienes a aprender a expresar tus emociones y talentos.",
                4: "El constructor (4). Tu misión es crear orden, estabilidad y seguridad. Vienes a aprender el valor del trabajo duro, la disciplina y la honestidad para construir un legado duradero.",
                5: "El aventurero (5). Tu misión es experimentar la libertad en todas sus formas. Vienes a aprender a adaptarte al cambio, a ser versátil y a usar tu libertad de forma constructiva.",
                6: "Tu camino (6) es el del amor y la responsabilidad. Tu misión es cuidar de tu familia y tu comunidad. Vienes a aprender sobre el servicio, el equilibrio y la belleza del hogar.",
                7: "El buscador de la verdad (7). Tu misión es analizar, investigar y conectar con tu sabiduría interior. Vienes a aprender a confiar en tu intuición y a compartir tu conocimiento.",
                8: "Tu sendero (8) es el del poder y la abundancia. Tu misión es manifestar el éxito material y usar tu poder con sabiduría. Vienes a aprender a equilibrar lo material y lo espiritual.",
                9: "El humanitario (9). Tu misión es servir a los demás y mostrar compasión. Vienes a aprender a soltar el pasado y a entregar tu amor de forma universal.",
                11: "Como maestro espiritual (11), tu misión es inspirar e iluminar a otros. Vienes a aprender a confiar en tu intuición elevada y a vivir de acuerdo a un ideal superior.",
                22: "El maestro constructor (22). Tu misión es convertir grandes sueños en realidad para el bien de la humanidad. Vienes a aprender a usar tu poder para crear un impacto duradero."
            },
            alma: {
                1: "Tu deseo más profundo es ser el número uno: liderar, ser independiente y pionero. Anhelas la autonomía y el reconocimiento por tus propios méritos.",
                2: "Buscas la armonía, la paz y la unión. Tu alma anhela la cooperación y las relaciones cercanas. La diplomacia y el amor son tus mayores motivaciones.",
                3: "Anhelas expresarte, socializar y disfrutar la vida. Tu alma se nutre de la creatividad, la comunicación y la alegría. La autoexpresión es tu motor.",
                4: "Necesitas seguridad, orden y estabilidad. Tu alma busca construir algo sólido y duradero. La planificación, el trabajo y la disciplina te dan paz.",
                5: "Ansías libertad, aventura y cambio constante. Tu alma se aburre con la rutina y busca nuevas experiencias. La variedad es esencial para tu felicidad.",
                6: "Tu mayor deseo es el amor, el hogar y la responsabilidad familiar. Tu alma se siente plena al cuidar y servir a los demás. La belleza y la armonía son tu refugio.",
                7: "Buscas la verdad y el conocimiento profundo. Tu alma es analítica e introspectiva, y anhela momentos de soledad para estudiar y conectar con tu sabiduría interior.",
                8: "Anhelas el éxito material, el poder y el control. Tu alma tiene una gran ambición y busca lograr grandes cosas en el mundo material para sentirse segura.",
                9: "Tu alma busca servir a la humanidad de forma desinteresada. Te motiva la compasión, el altruismo y el deseo de hacer del mundo un lugar mejor.",
                11: "Deseas inspirar, canalizar mensajes y elevar la conciencia de otros. Tu alma tiene una misión espiritual y busca la iluminación por encima de todo.",
                22: "Anhelas construir algo grande y duradero que beneficie a la humanidad. Tu alma tiene el potencial de convertir sueños idealistas en realidades tangibles."
            },
            personalidad: {
                1: "Proyectas una imagen de líder seguro, capaz e independiente. La gente te ve como alguien que toma la iniciativa y no teme estar al frente.",
                2: "Pareces diplomático, amable y pacífico. La gente te percibe como un mediador natural, alguien que busca la armonía y evita el conflicto.",
                3: "Te ven como alguien sociable, encantador y lleno de carisma. Proyectas una energía optimista y creativa que atrae a los demás.",
                4: "Proyectas una imagen de seriedad, confianza y trabajo duro. La gente te ve como alguien estable, organizado y en quien se puede confiar.",
                5: "Pareces versátil, aventurero y amante de la libertad. Proyectas una energía magnética y curiosa, como si siempre estuvieras listo para algo nuevo.",
                6: "Te perciben como alguien responsable, protector y hogareño. La gente confía en ti para dar consejos y te ve como el pilar de tu comunidad o familia.",
                7: "Proyectas un aire de misterio, sabiduría e intelecto. Pareces reservado y analítico, alguien que prefiere la profundidad a la superficialidad.",
                8: "Te ven como una persona poderosa, exitosa y con autoridad. Proyectas una imagen de control y ambición que inspira respeto (y a veces intimidación).",
                9: "Pareces compasivo, humanitario y carismático. La gente se siente atraída por tu energía generosa y tu aparente sabiduría sobre la vida.",
                11: "Proyectas una intensa energía espiritual e idealismo. La gente te percibe como alguien intuitivo, sensible y con una conexión especial con lo invisible.",
                22: "Te ven como un maestro constructor, una persona práctica con grandes visiones. Proyectas la capacidad de lograr lo que para otros parece imposible."
            },
            regalo: {
                1: "Tu don es la originalidad y el liderazgo. Tienes la capacidad innata de iniciar proyectos y ser pionero. ¡Confía en tus ideas!",
                2: "Tu regalo es la diplomacia y la sensibilidad. Eres un mediador natural que sabe cómo unir a las personas y crear armonía.",
                3: "La comunicación es tu don. Tienes un talento natural para la expresión creativa, ya sea escribiendo, hablando o en las artes.",
                4: "Tu regalo es la organización y la disciplina. Tienes la habilidad de construir sistemas sólidos y traer orden al caos.",
                5: "La versatilidad es tu don. Te adaptas fácilmente al cambio y tienes un talento para la comunicación y la venta de ideas.",
                6: "Tu regalo es la capacidad de nutrir y sanar. Tienes un don para crear belleza, armonía y cuidar de los demás.",
                7: "La sabiduría interior es tu regalo. Eres un pensador profundo con una gran intuición y la capacidad de ver más allá de lo superficial.",
                8: "Tu don es el poder de la manifestación. Tienes un talento natural para los negocios, las finanzas y el liderazgo ejecutivo.",
                9: "La compasión es tu regalo. Tienes una habilidad innata para entender a los demás y un gran corazón para el servicio humanitario."
            },
            karma: {
                1: "Debes aprender a ser más independiente y a desarrollar la confianza en ti mismo, sin depender de la aprobación de los demás.",
                2: "Tu lección es aprender a cooperar y a ser diplomático. Necesitas desarrollar la paciencia y la sensibilidad hacia los sentimientos ajenos.",
                3: "La lección es aprender a expresar tus emociones de forma positiva y a no tomar la vida tan en serio. La alegría y la creatividad son tu tarea.",
                4: "Necesitas aprender el valor del trabajo duro y la disciplina. La lección es ser más organizado, práctico y construir bases sólidas.",
                5: "Tu lección es aprender a manejar la libertad de forma constructiva, evitando los excesos y el miedo al compromiso.",
                6: "Debes aprender a aceptar la responsabilidad en el hogar y en tus relaciones, equilibrando el dar y el recibir.",
                7: "Tu karma te pide que desarrolles la fe y la confianza en lo invisible. La lección es conectar con tu sabiduría interior y no ser excesivamente escéptico.",
                8: "La lección es aprender a manejar el poder y el dinero con sabiduría y generosidad, evitando ser demasiado dominante o materialista.",
                9: "Debes aprender a soltar, a perdonar y a servir a los demás sin esperar nada a cambio. La compasión universal es tu meta.",
                "Ninguno": "¡Felicidades! No tienes lecciones kármicas pendientes por tu nombre. Esto te da una mayor libertad para enfocarte en tu misión de vida."
            },
            conexiones: {
                1: { natural: "1, 5, 7", compatible: "2, 3, 9", desafio: "4, 6, 8" },
                2: { natural: "2, 4, 8", compatible: "1, 3, 6, 9", desafio: "5, 7" },
                3: { natural: "3, 6, 9", compatible: "1, 2, 5", desafio: "4, 7, 8" },
                4: { natural: "2, 4, 8", compatible: "3, 6, 7", desafio: "1, 5, 9" },
                5: { natural: "1, 5, 7", compatible: "3, 9", desafio: "2, 4, 6", neutral: "8" },
                6: { natural: "3, 6, 9", compatible: "2, 4, 8", desafio: "1, 5, 7" },
                7: { natural: "1, 5, 7", compatible: "4, 6", desafio: "2, 3, 8, 9" },
                8: { natural: "2, 4, 8", compatible: "5, 6", desafio: "1, 3, 7, 9" },
                9: { natural: "3, 6, 9", compatible: "1, 2, 5", desafio: "4, 7, 8" },
                11: { natural: "2, 4, 8", compatible: "1, 3, 6, 9", desafio: "5, 7" },
                22: { natural: "2, 4, 8", compatible: "3, 6, 7", desafio: "1, 5, 9" }
            },
            añoPersonal: {
                1: { color: "Rojo", joya: "Rubí", palabra: "COMIENZO", desc: "Es tiempo para sembrar. Nuevos proyectos, cambios y planes. Asume el control." },
                2: { color: "Anaranjado", joya: "Piedra de Luna", palabra: "PACIENCIA", desc: "Momento de unión, diplomacia y calma. Fortalece relaciones y no fuerces las cosas." },
                3: { color: "Amarillo", joya: "Topacio", palabra: "GOZO", desc: "Año para socializar, crea y comunicar. Diviértete, sonríe y expande tu círculo." },
                4: { color: "Verde", joya: "Esmeralda", palabra: "PRÁCTICO", desc: "Año de ardua labor y construcción. Organiza, ahorra y construye bases firmes." },
                5: { color: "Azul", joya: "Turquesa", palabra: "CAMBIO", desc: "Espera lo inesperado. Año de libertad, viajes y aventura. Aléjate de la rutina." },
                6: { color: "Añil", joya: "Perla", palabra: "RESPONSABILIDAD", desc: "Centrado en el amor, hogar y familia. Acepta obligaciones y embellece tu entorno." },
                7: { color: "Morado", joya: "Amatista", palabra: "FE", desc: "Año espiritual para la reflexión. Tómate tiempo para ti, medita y contacta con la naturaleza." },
                8: { color: "Beige/Rosa", joya: "Diamante", palabra: "LOGRO", desc: "Tiempo de cosecha, éxito y dinero. Invierte, organiza y sé ejecutivo." },
                9: { color: "Tonos Pastel", joya: "Ópalo", palabra: "TERMINACIÓN", desc: "Cierre de ciclos. Limpia y elimina lo que ya no sirve. Deja ir el pasado." },
                11: { color: "Plata", joya: "Plata", palabra: "INTUICIÓN", desc: "Año de activación espiritual. Brilla y establece nuevas normas. Crecimiento interior." },
                22: { color: "Coral", joya: "Cobre", palabra: "CONSTRUCCIÓN", desc: "Colabora en proyectos importantes para la sociedad. Materializa tus sueños a gran escala." }
            },
            diaPersonal: { 
                 1: { color: "Rojo", hex: "#ef4444", grad: "from-red-500 to-orange-500", consejo: "Hoy es perfecto para presentar esa nueva idea que tienes. ¡Toma la iniciativa!", afirmacion: "Confío en mi capacidad para liderar y empezar de nuevo.", ropa: { color: "Rojo", frase: "potenciar tu energía de liderazgo e iniciativa." } },
                 2: { color: "Naranja", hex: "#f97316", grad: "from-orange-400 to-amber-400", consejo: "Escucha más de lo que hablas. La clave de hoy está en la diplomacia y el trabajo en equipo.", afirmacion: "Atraigo relaciones armoniosas a través de la paciencia y la cooperación.", ropa: { color: "Naranja", frase: "fomentar la cooperación y la calidez en tus interacciones." } },
                 3: { color: "Amarillo", hex: "#eab308", grad: "from-yellow-300 to-lime-300", consejo: "Comunícate, socializa y ríe. Tu energía positiva atraerá buenas oportunidades.", afirmacion: "Expreso mi alegría y creatividad libremente.", ropa: { color: "Amarillo", frase: "atraer la alegría y estimular tu creatividad." } },
                 4: { color: "Verde", hex: "#22c55e", grad: "from-green-400 to-teal-400", consejo: "Es día de arremangarse. Organiza tus finanzas, tu casa o tu agenda. El esfuerzo de hoy dará frutos.", afirmacion: "Construyo mi futuro sobre bases sólidas y seguras.", ropa: { color: "Verde", frase: "atraer el equilibrio y la energía de crecimiento." } },
                 5: { color: "Azul", hex: "#06b6d4", grad: "from-cyan-400 to-sky-400", consejo: "Rompe la rutina. Prueba un camino diferente para ir al trabajo, come algo nuevo o atrévete a esa aventura.", afirmacion: "Acepto el cambio con valentía y disfruto de mi libertad.", ropa: { color: "Azul", frase: "facilitar la comunicación y la expresión de tus ideas." } },
                 6: { color: "Añil", hex: "#4338ca", grad: "from-indigo-600 to-blue-800", consejo: "Llama a un ser querido o dedica tiempo a embellecer tu hogar. El amor y el deber llaman.", afirmacion: "Asumo mis responsabilidades con amor y dedicación.", ropa: { color: "Añil", frase: "fortalecer los lazos afectivos y la armonía en el hogar." } },
                 7: { color: "Violeta", hex: "#9333ea", grad: "from-purple-500 to-fuchsia-500", consejo: "Evita las multitudes. Busca un momento de soledad para leer, meditar o simplemente analizar tus pensamientos.", afirmacion: "Encuentro sabiduría y paz en mi mundo interior.", ropa: { color: "Morado", frase: "conectar con tu intuición y tu lado espiritual." } },
                 8: { color: "Rosa", hex: "#ec4899", grad: "from-pink-400 to-rose-400", consejo: "Es un día de poder. Ideal para negociar un aumento, cerrar un trato o presentar un presupuesto. ¡Piensa en grande!", afirmacion: "Soy un imán para el éxito, la abundancia y el poder material.", ropa: { color: "Beige, Rosa o Café", frase: "alinearte con la energía de la abundancia y el éxito." } },
                 9: { color: "Pastel", hex: "#c4b5fd", grad: "from-indigo-200 to-purple-200", consejo: "Suelta lo que ya no sirve. Termina ese proyecto pendiente, dona ropa que no usas o perdona una vieja ofensa.", afirmacion: "Libero el pasado con gratitud y me abro a la sabiduría universal.", ropa: { color: "Tonos Pastel", frase: "fomentar la compasión y la generosidad." } },
                 11: { color: "Blanco/Gris", hex: "#d1d5db", grad: "from-gray-200 to-slate-200", consejo: "Presta atención a tus corazonadas y sueños. Hoy tu intuición está en su punto más alto.", afirmacion: "Mi intuición es mi guía más poderosa.", ropa: { color: "Blanco, Negro o Gris", frase: "amplificar tu intuición y tu conexión espiritual." } },
                 22: { color: "Coral", hex: "#fb923c", grad: "from-red-300 to-orange-300", consejo: "Tus acciones de hoy pueden tener un gran impacto. Piensa en cómo puedes beneficiar a tu comunidad.", afirmacion: "Materializo grandes sueños para el bien de todos.", ropa: { color: "Coral o Castaño", frase: "materializar tus ideas y construir proyectos sólidos." } }
            },
            periodos: {
                1: { debil: "Oct, Nov, Dic", fuerte: "21 Mar - 28 Abr, 23 Jul - 31 Ago", favorables: ["Domingo", "Lunes"] },
                2: { debil: "Dic, Ene, Feb", fuerte: "22 Jun - 29 Jul", favorables: ["Lunes", "Domingo"] },
                3: { debil: "Oct, 1-18 Nov", fuerte: "19 Feb - 28 Mar, 21 Nov - 28 Dic", favorables: ["Lunes", "Miércoles", "Jueves"] },
                4: { debil: "Oct, Nov, Dic", fuerte: "21 Mar - 30 Abr, 23 Jul - 29 Ago", favorables: ["Sábado", "Domingo", "Lunes"] },
                5: { debil: "1-21 May, Dic", fuerte: "22 May - 30 Jun, 22 Ago - 30 Sep", favorables: ["Miércoles", "Viernes"] },
                6: { debil: "1-20 Abr, Nov", fuerte: "21 Abr - 28 May, 23 Sep - 30 Oct", favorables: ["Viernes", "Miércoles"] },
                7: { debil: "Ene, Feb", fuerte: "22 Jun - 30 Jul", favorables: ["Domingo", "Lunes", "Miércoles"] },
                8: { debil: "27-28 Feb, Mar, Abr", fuerte: "21 Dic - 27 Ene, 20 Ene - 26 Feb", favorables: ["Sábado"] },
                9: { debil: "1-20 Mar, May, Jun, 1-20 Oct, 27 Nov - 27 Dic", fuerte: "21 Mar - 30 Abr, 23 Oct - 30 Nov", favorables: ["Martes", "Viernes"] }
            }
        };

        const astrologicalEvents = {
            "2025-03-14": { icon: "💫", name: "Eclipse Lunar Total", desc: "Finales y revelaciones emocionales. Lo que estaba oculto sale a la luz. Es un momento de cierre y liberación." },
            "2025-03-20": { icon: "⚖️", name: "Equinoccio de Primavera", desc: "El Año Nuevo Astrológico. Un día de equilibrio perfecto entre luz y oscuridad, ideal para iniciar proyectos con energía renovada." },
            "2025-03-29": { icon: "💫", name: "Eclipse Solar Parcial", desc: "Un poderoso nuevo comienzo. Ideal para plantar intenciones audaces, pero evita tomar decisiones impulsivas. La energía es potente pero caótica." },
            "2025-04-01": { icon: "⏪", name: "Inicia Mercurio Retrógrado", desc: "Comunicación, tecnología y viajes se complican. Revisa, repara y reconsidera. No es momento de firmar contratos ni empezar proyectos nuevos." },
            "2025-04-25": { icon: "⏩", name: "Termina Mercurio Retrógrado", desc: "La claridad regresa. Los planes pueden avanzar. Es buen momento para implementar lo que reconsideraste durante el retrógrado." },
            "2025-06-21": { icon: "☀️", name: "Solsticio de Verano", desc: "El día más largo del año. Un portal de máxima energía solar, perfecto para celebrar la vida, la abundancia y la autoexpresión." },
            "2025-09-07": { icon: "💫", name: "Eclipse Lunar Total", desc: "Un clímax emocional importante. Prepárate para soltar lo que ya no te sirve y ver culminar situaciones de los últimos 6 meses." },
            "2025-09-21": { icon: "💫", name: "Eclipse Solar Parcial", desc: "Nuevas oportunidades en relaciones y asociaciones. Un buen momento para iniciar colaboraciones, pero con cautela y claridad." },
            "2025-09-22": { icon: "⚖️", name: "Equinoccio de Otoño", desc: "Un tiempo de balance y gratitud. La energía se enfoca en cosechar lo sembrado y prepararse para un ciclo de introspección." },
            "2025-12-21": { icon: "❄️", name: "Solsticio de Invierno", desc: "La noche más larga del año. Un portal energético para la introspección, el descanso y el renacimiento de la luz interior." },
        };
        
        const form = document.getElementById('numerology-form');
        const portalSection = document.getElementById('portal');
        const resultsSection = document.getElementById('results');
        const generalModal = document.getElementById('general-modal');
        const modalContent = document.getElementById('modal-content');

        let currentUserData = {};
        let currentDate = new Date();

        function runCalculation(name, birthdateStr) {
            const birthdate = new Date(birthdateStr + 'T00:00:00');
            const diaNac = birthdate.getDate();
            const mesNac = birthdate.getMonth() + 1;
            const anoNac = birthdate.getFullYear();
            const anoNacStr = String(anoNac);
            
            const numeroDiaNacimiento = reducirNumero(diaNac, false);
            const caminoVida = reducirNumero(diaNac + mesNac + reducirNumero(anoNac));
            const alma = calculateNameNumber(name, 'vowels');
            const personalidad = calculateNameNumber(name, 'consonants');
            const destino = reducirNumero(alma + personalidad);
            const regalo = reducirNumero(parseInt(anoNacStr.slice(-2)[0]) + parseInt(anoNacStr.slice(-2)[1]));
            const karma = calculateKarmaNumbers(name);

            const hoy = new Date();
            const anoPlanetario = (hoy.getFullYear() > birthdate.getFullYear() || (hoy.getMonth() > birthdate.getMonth() || (hoy.getMonth() === birthdate.getMonth() && hoy.getDate() >= birthdate.getDate()))) ? hoy.getFullYear() : hoy.getFullYear() - 1;
            const anoPersonal = reducirNumero(diaNac + mesNac + anoPlanetario);

            currentUserData = { name, birthdate, diaNac, numeroDiaNacimiento, caminoVida, alma, personalidad, destino, regalo, karma, anoPersonal };

            document.getElementById('user-name-title').textContent = name.split(' ')[0];
            
            portalSection.style.opacity = 0;
            setTimeout(() => {
                portalSection.classList.add('hidden');
                resultsSection.classList.remove('hidden');
                displayResults();
                document.getElementById('calendar-title').textContent = `Calendario Cósmico para ${name}`;
                document.getElementById('calendar-subtitle').textContent = `Nacimiento: ${birthdate.toLocaleDateString('es-ES', { day: 'numeric', month: 'long', year: 'numeric' })}`;
                buildCalendar(currentDate);
                resultsSection.style.opacity = 1;
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, 500);
        }

        window.onload = () => {
            const params = new URLSearchParams(window.location.search);
            const data = params.get('data');

            if (data) {
                try {
                    const decodedData = JSON.parse(atob(data));
                    runCalculation(decodedData.name, decodedData.birthdate);
                } catch (e) {
                    console.error("Error al decodificar los datos del link:", e);
                    portalSection.classList.remove('hidden');
                }
            } else {
                portalSection.classList.remove('hidden');
            }
        };

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const birthdateStr = document.getElementById('birthdate').value;
            runCalculation(name, birthdateStr);
        });
        
        document.getElementById('sinergia-form').addEventListener('submit', (e) => {
             e.preventDefault();
            const otherName = document.getElementById('other-name').value;
            const otherBirthdateValue = document.getElementById('other-birthdate').value;
            if(!otherName || !otherBirthdateValue) {
                document.getElementById('sinergia-result').innerHTML = `<p class="text-red-400">Por favor, completa ambos campos.</p>`;
                return;
            }

            const otherBirthdate = new Date(otherBirthdateValue + 'T00:00:00');
            const otherCamino = reducirNumero(otherBirthdate.getDate() + (otherBirthdate.getMonth() + 1) + reducirNumero(otherBirthdate.getFullYear()));
            const otherAlma = calculateNameNumber(otherName, 'vowels');
            const otherPersonalidad = calculateNameNumber(otherName, 'consonants');
            
            const myCamino = currentUserData.caminoVida;
            const myAlma = currentUserData.alma;
            const myPersonalidad = currentUserData.personalidad;

            const myConexiones = infoNumeros.conexiones[myCamino];
            let resultado = "Neutral";
            let desc = "Una relación con potencial para crecer en cualquier dirección con esfuerzo.";
            
            if (myConexiones.natural.split(', ').includes(String(otherCamino))) {
                resultado = "Natural 🍃";
                desc = "Sus caminos fluyen juntos sin esfuerzo. Una conexión fácil y cómoda.";
            } else if (myConexiones.compatible.split(', ').includes(String(otherCamino))) {
                resultado = "Compatible ✨";
                desc = "Sus senderos se entienden y apoyan mutuamente. Gran potencial para la armonía.";
            } else if (myConexiones.desafio.split(', ').includes(String(otherCamino))) {
                resultado = "Desafío �";
                desc = "Una relación kármica con grandes lecciones que aprender. Requiere paciencia y comprensión.";
            }
            
            let almaComp = myAlma === otherAlma ? "Sus almas desean lo mismo, una conexión profunda." : "Sus deseos internos son diferentes, lo que puede enriquecerlos o crear fricción.";
            let personalidadComp = myPersonalidad === otherPersonalidad ? "Se proyectan al mundo de forma similar." : "La forma en que se muestran al mundo es distinta, deben aprender a entender sus estilos.";

            document.getElementById('sinergia-result').innerHTML = `
                <h4 class="font-bold text-xl text-purple-300">${resultado}</h4>
                <p class="text-white text-sm">${desc}</p>
                <div class="text-xs mt-2 text-gray-400">
                    <p><strong>Almas:</strong> ${almaComp}</p>
                    <p><strong>Personalidades:</strong> ${personalidadComp}</p>
                </div>`;
        });

        function displayResults() {
            const { caminoVida, alma, personalidad, destino, regalo, karma, anoPersonal } = currentUserData;

            // Tarjeta Camino de Vida
            const cvCard = document.getElementById('camino-vida-card');
            cvCard.innerHTML = `<h3 class="font-bold text-xl text-cyan-300">Camino de Vida</h3><p class="text-7xl font-bold text-white">${caminoVida}</p><p class="text-xs text-gray-400">Tu misión y lecciones.</p>`;
            cvCard.onclick = () => showCardDetails('caminoVida');
            
            // Tarjeta Alma
            const almaCard = document.getElementById('alma-card');
            almaCard.innerHTML = `<h3 class="font-bold text-xl text-cyan-300">Alma</h3><p class="text-7xl font-bold text-white">${alma}</p><p class="text-xs text-gray-400">Tus deseos internos.</p>`;
            almaCard.onclick = () => showCardDetails('alma');

            // Tarjeta Personalidad
            const pCard = document.getElementById('personalidad-card');
            pCard.innerHTML = `<h3 class="font-bold text-xl text-cyan-300">Personalidad</h3><p class="text-7xl font-bold text-white">${personalidad}</p><p class="text-xs text-gray-400">Cómo te ven los demás.</p>`;
            pCard.onclick = () => showCardDetails('personalidad');

            // Tarjeta Regalo
            const rCard = document.getElementById('regalo-card');
            rCard.innerHTML = `<h3 class="font-bold text-xl text-cyan-300">Regalo Divino</h3><p class="text-7xl font-bold text-white">${regalo}</p><p class="text-xs text-gray-400">Tu don natural.</p>`;
            rCard.onclick = () => showCardDetails('regalo');
            
            // Tarjeta Karma
            const kCard = document.getElementById('karma-card');
            kCard.innerHTML = `<h3 class="font-bold text-xl text-cyan-300">Karma</h3><p class="text-5xl font-bold text-white">${karma.join(', ')}</p><p class="text-xs text-gray-400">Lecciones a aprender.</p>`;
            kCard.onclick = () => showCardDetails('karma');

            // Tarjeta Año Personal
            const apCard = document.getElementById('ano-personal-card');
            apCard.innerHTML = `<h3 class="font-bold text-xl text-cyan-300">Año Personal</h3><p class="text-7xl font-bold text-white">${anoPersonal}</p><p class="text-xs text-gray-400">Tu energía para este año.</p>`;
            apCard.onclick = () => showCardDetails('anoPersonal');
        }

        function showCardDetails(type) {
            const { caminoVida, alma, personalidad, destino, regalo, karma, anoPersonal } = currentUserData;
            let title = '';
            let content = '';

            switch (type) {
                case 'caminoVida':
                    const conexiones = infoNumeros.conexiones[caminoVida];
                    title = `Camino de Vida ${caminoVida}`;
                    content = `<p class="text-sm mb-4">${infoNumeros.caminoVida[caminoVida]}</p>
                               <hr class="my-3 border-white/20">
                               <h4 class="font-bold text-cyan-300 mb-2">Conexiones</h4>
                               <div class="text-xs text-left space-y-1">
                                <p><strong class="text-green-400">Natural:</strong> ${conexiones.natural}</p>
                                <p><strong class="text-blue-400">Compatible:</strong> ${conexiones.compatible}</p>
                                <p><strong class="text-red-400">Desafío:</strong> ${conexiones.desafio}</p>
                               </div>`;
                    break;
                case 'alma':
                    title = `Número de Alma ${alma}`;
                    content = `<p class="text-sm">${infoNumeros.alma[alma]}</p>`;
                    break;
                case 'personalidad':
                    title = `Número de Personalidad ${personalidad}`;
                    content = `<p class="text-sm mb-4">${infoNumeros.personalidad[personalidad]}</p>
                               <hr class="my-3 border-white/20">
                               <p class="font-bold text-cyan-300">Destino: ${destino}</p>`;
                    break;
                case 'regalo':
                     title = `Regalo Divino ${regalo}`;
                    content = `<p class="text-sm">${infoNumeros.regalo[regalo]}</p>`;
                    break;
                case 'karma':
                    const karmaText = karma[0] === "Ninguno" ? `<p class="text-sm">${infoNumeros.karma["Ninguno"]}</p>` : karma.map(k => `<p class="text-sm"><strong class="text-cyan-300">${k}:</strong> ${infoNumeros.karma[k]}</p>`).join('');
                    title = `Lecciones Kármicas`;
                    content = `<div class="space-y-2">${karmaText}</div>`;
                    break;
                case 'anoPersonal':
                    const anoInfo = infoNumeros.añoPersonal[anoPersonal];
                    title = `Año Personal ${anoPersonal}`;
                    content = `<h3 class="font-bold text-2xl mb-2" style="color:${anoInfo.color.toLowerCase()}">${anoInfo.palabra}</h3>
                               <p class="text-sm"><strong>Joya:</strong> ${anoInfo.joya}</p>
                               <p class="text-sm mt-4">${anoInfo.desc}</p>`;
                    break;
            }

            modalContent.innerHTML = `<h3 class="main-title text-3xl font-bold mb-4">${title}</h3>
                                      <div class="text-gray-300">${content}</div>
                                      <button id="close-modal" class="mt-6 w-full p-2 bg-cyan-500 text-white font-bold rounded-lg glow-button">Cerrar</button>`;
            generalModal.classList.remove('hidden');
        }
        
        function buildCalendar(date) {
            const { anoPersonal, numeroDiaNacimiento } = currentUserData;
            const month = date.getMonth();
            const year = date.getFullYear();

            document.getElementById('month-year').textContent = date.toLocaleDateString('es-ES', { month: 'long', year: 'numeric' }).replace(/^\w/, c => c.toUpperCase());
            const calendarGrid = document.getElementById('calendar-grid');
            calendarGrid.innerHTML = '';
            const diasSemana = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];
            diasSemana.forEach(dia => { calendarGrid.innerHTML += `<div class="text-center font-bold text-cyan-300 text-xs sm:text-base">${dia}</div>`; });
            const firstDayOfMonth = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            for (let i = 0; i < firstDayOfMonth; i++) { calendarGrid.innerHTML += `<div></div>`; }

            for (let i = 1; i <= daysInMonth; i++) {
                const currentDayDate = new Date(year, month, i);
                const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                const astroEvent = astrologicalEvents[dateString];

                const diaDeLaSemana = diasSemana[currentDayDate.getDay()];
                const periodosDiaNac = infoNumeros.periodos[numeroDiaNacimiento] || { favorables: [] };
                const isFavorable = periodosDiaNac.favorables.includes(diaDeLaSemana);
                
                const mesPersonal = reducirNumero(anoPersonal + (month + 1));
                const diaPersonal = reducirNumero(mesPersonal + i);
                const diaInfo = infoNumeros.diaPersonal[diaPersonal];
                let dayClasses = `calendar-day glassmorphism rounded-lg text-center cursor-pointer flex flex-col items-center justify-center aspect-square p-1`;
                if (new Date().toDateString() === currentDayDate.toDateString()) dayClasses += ' day-pulse';
                const moonPhase = getMoonPhase(currentDayDate);
                
                const dayElement = document.createElement('div');
                dayElement.className = dayClasses;
                dayElement.style.background = `linear-gradient(45deg, ${diaInfo.grad.split(' ')[0].replace('from-', 'var(--tw-gradient-from, #000)')}, ${diaInfo.grad.split(' ')[1].replace('to-', 'var(--tw-gradient-to, #000)')})`;
                
                dayElement.innerHTML = `<span class="text-lg sm:text-2xl font-bold" style="color: ${diaPersonal > 9 ? 'black' : 'white'}; text-shadow: 0 0 5px black;">${i}</span><span class="text-xs sm:text-sm font-bold" style="color: ${diaPersonal > 9 ? 'black' : 'white'}; text-shadow: 0 0 5px black;">${diaPersonal}</span><div class="flex text-xs mt-1 gap-1 items-center"><span>${moonPhase.icon}</span>${astroEvent ? `<span>${astroEvent.icon}</span>` : ''}${isFavorable ? '<span class="text-yellow-300">⭐</span>' : ''}</div>`;
                dayElement.onclick = () => showDayDetails(currentDayDate, diaPersonal, diaInfo, moonPhase, astroEvent);
                calendarGrid.appendChild(dayElement);
            }
        }

        function showDayDetails(date, diaPersonal, diaInfo, moonPhase, astroEvent) {
            let astroEventHtml = '';
            if (astroEvent) {
                astroEventHtml = `
                <div class="glassmorphism rounded-lg p-3 my-2 text-left">
                    <h4 class="font-bold text-red-400 mb-1">${astroEvent.icon} Evento Astrológico: ${astroEvent.name}</h4>
                    <p class="text-sm pl-6">${astroEvent.desc}</p>
                </div>`;
            }

            modalContent.innerHTML = `
                <p class="text-xl font-bold mb-2">${date.toLocaleDateString('es-ES', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>
                <div class="mb-4">
                    <p class="text-6xl font-bold" style="color:${diaInfo.hex}">${diaPersonal}</p>
                    <p class="text-xl font-bold" style="color:${diaInfo.hex}">Día ${diaInfo.color}</p>
                </div>
                ${astroEventHtml}
                <div class="glassmorphism rounded-lg p-3 my-2 text-left">
                    <h4 class="font-bold text-yellow-300 mb-1 flex items-center"><span class="w-4 h-4 rounded-full mr-2 border border-white/20" style="background-color:${diaInfo.hex};"></span>Vibración de Color</h4>
                    <p class="text-sm pl-6">Viste de <strong>${diaInfo.ropa.color}</strong> para ${diaInfo.ropa.frase}</p>
                </div>
                <div class="glassmorphism rounded-lg p-3 my-2 text-left">
                    <h4 class="font-bold text-cyan-300 mb-1">💡 Consejo del Día</h4>
                    <p class="text-sm pl-6">${diaInfo.consejo}</p>
                </div>
                 <div class="glassmorphism rounded-lg p-3 my-2 text-left">
                    <h4 class="font-bold text-purple-300 mb-1">✨ Afirmación del Día</h4>
                    <p class="text-sm italic pl-6">"${diaInfo.afirmacion}"</p>
                </div>
                <div class="text-left space-y-2 text-xs mt-4">
                    <p><strong>Fase Lunar:</strong> ${moonPhase.icon} ${moonPhase.name}</p>
                </div>
                <button id="close-modal" class="mt-6 w-full p-2 bg-cyan-500 text-white font-bold rounded-lg glow-button">Cerrar</button>`;
            
            generalModal.classList.remove('hidden');
        }

        function getMoonPhase(date) {
            const dayOfMonth = date.getDate();
            if (dayOfMonth < 4) return {icon: "🌑", name: "Luna Nueva"};
            if (dayOfMonth < 11) return {icon: "🌓", name: "Cuarto Creciente"};
            if (dayOfMonth < 18) return {icon: "🌕", name: "Luna Llena"};
            if (dayOfMonth < 26) return {icon: "🌗", name: "Cuarto Menguante"};
            return {icon: "🌑", name: "Luna Nueva"};
        }
        
        generalModal.addEventListener('click', (e) => { 
            if (e.target.id === 'general-modal' || e.target.id === 'close-modal') {
                generalModal.classList.add('hidden');
            }
        });
        document.getElementById('prev-month').addEventListener('click', () => { currentDate.setMonth(currentDate.getMonth() - 1); buildCalendar(currentDate); });
        document.getElementById('next-month').addEventListener('click', () => { currentDate.setMonth(currentDate.getMonth() + 1); buildCalendar(currentDate); });

    </script>
</body>
</html>
